# 跨站点请求伪造(Cross Site Request Forgery)

## 原理简单说明

用户登录合法网站A后，浏览器会受到A网站发来的Cookie，用以方便后期用户身份认证，浏览器在Cookie有效期期间访问A网站都会带上这个Cookie，而此时若用户访问了恶意网站B，B网站中嵌入了使浏览器访问A网站的JS代码，那么浏览器在用户不知情的情况下访问了A网站，带上了用户的合法Cookie，还可能发送了恶意指令。

## 防范方法

1. 验证码

有些时候可用，但有些时候也不好用，不能作为主要的解决手段

2. Referer Check

referer字段，告诉服务器这个请求的来源是哪个网页。

但这完全依赖于浏览器对这个字段的支持，有些浏览器提供了修改这个值的功能，不安全

而有些用户认为这个值会泄露一些信息，有风险，禁止使用

所以CSRF的防范不能完全依赖这个方法

3. Token

服务器端随机生成一个token，并将其放入cookie返回给前端，同源页面发送http请求时都在请求头或者请求参数中加入cookie中取出来的token完成验证。而CSRF攻击只能通过浏览器自动带上cookie，不能读写cookie来获取token并改造http请求参数。